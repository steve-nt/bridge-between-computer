================================================================================
SSM SETUP CHECKLIST - WITH YOUR INSTANCE IDs
================================================================================

YOUR INSTANCES:
  1. i-03b3951e1cff6aa9b
  2. i-0a6b2c4bdce290dd0
  3. i-0d91bf046fcb0be90

REGION: eu-north-1
ASG: D7078E-MINI-PROJECT-GROUP35-ASG
STATUS: Ready to add SSM support

TOTAL TIME: ~10 minutes

================================================================================
STEP 1: CREATE IAM ROLE (2 minutes)
================================================================================

â˜ 1.1 Go to AWS Console â†’ IAM â†’ Roles
    URL: https://console.aws.amazon.com/iam/

â˜ 1.2 Click "Create role" (orange button, top-right)

â˜ 1.3 Select trusted entity type:
    â†’ Service

â˜ 1.4 Select service:
    â†’ EC2

â˜ 1.5 Click "Next"

â˜ 1.6 Add permissions:
    Search: "AmazonSSMManagedInstanceCore"
    âœ“ Check the box
    
    (Optional) Also add:
    Search: "AmazonSSMPatchAssociation"
    âœ“ Check the box

â˜ 1.7 Click "Next"

â˜ 1.8 Name the role:
    Role name: D7078E-EC2-SSM-Role
    Description: Role for EC2 instances in D7078E mini project to use SSM

â˜ 1.9 Click "Create role"

â˜ 1.10 Verify: You see green banner "Role D7078E-EC2-SSM-Role created successfully"

âœ“ STEP 1 COMPLETE - IAM role created!

================================================================================
STEP 2: UPDATE LAUNCH TEMPLATE (2 minutes)
================================================================================

â˜ 2.1 Go to AWS Console â†’ EC2 â†’ Launch Templates
    URL: https://eu-north-1.console.aws.amazon.com/ec2/

â˜ 2.2 Find your Launch Template:
    Name: D7078E-MINI-PROJECT-GROUP35-LT (or similar)

â˜ 2.3 Click on the Launch Template name

â˜ 2.4 Click "Actions" dropdown (top-right)

â˜ 2.5 Select: "Create new version"
    (This creates Version 2 without modifying Version 1)

â˜ 2.6 Scroll down to "Advanced Details" section

â˜ 2.7 Find "IAM instance profile" field

â˜ 2.8 Click the dropdown

â˜ 2.9 Search for: "D7078E-EC2-SSM-Role"
    (The role you just created)

â˜ 2.10 Select it

â˜ 2.11 Scroll to bottom

â˜ 2.12 Click "Create launch template version" (green button)

â˜ 2.13 Verify: You see "Launch Template Version 2 created successfully"

â˜ 2.14 Go back to Launch Templates list

â˜ 2.15 Click on your Launch Template name again

â˜ 2.16 Find Version 2

â˜ 2.17 Right-click Version 2 â†’ "Set as default"
    (OR select it and use Actions dropdown)

â˜ 2.18 Verify: Version 2 is now marked as default

âœ“ STEP 2 COMPLETE - Launch Template updated!

================================================================================
STEP 3: TERMINATE OLD INSTANCES (1 minute)
================================================================================

âš  CRITICAL: You MUST terminate these 3 old instances so ASG launches new ones
             with the SSM role!

â˜ 3.1 Go to AWS Console â†’ EC2 â†’ Instances

â˜ 3.2 Find and select BOTH instances:
    â˜‘ i-03b3951e1cff6aa9b
    â˜‘ i-0a6b2c4bdce290dd0
    â˜‘ i-0d91bf046fcb0be90
    
    (Tip: Use Ctrl+Click to select multiple)

â˜ 3.3 Click "Instance State" dropdown (top menu)

â˜ 3.4 Select: "Terminate instances"

â˜ 3.5 Confirmation popup appears

â˜ 3.6 Click "Terminate" button

â˜ 3.7 Watch instances change state:
    â†’ shutting-down
    â†’ terminated

âœ“ STEP 3 COMPLETE - Old instances terminating!

WHAT HAPPENS NEXT (Automatic - no action needed):
  1. All 3 instances terminate (~30 seconds)
  2. ASG detects: "We have 0 instances, but need 3"
  3. ASG launches 3 NEW instances using:
     â†’ Launch Template Version 2 (with SSM role!)
     â†’ Same configuration as before
  4. New instances boot (takes ~5-7 minutes)

================================================================================
STEP 4: WAIT FOR NEW INSTANCES TO BOOT (5-7 minutes)
================================================================================

â³ What to do while waiting:
  â€¢ Get coffee â˜•
  â€¢ Watch EC2 Instances tab
  â€¢ See new instances in "Pending" state â†’ "Running" state

â˜ 4.1 Go to EC2 â†’ Instances

â˜ 4.2 Refresh page (F5) every 30 seconds

â˜ 4.3 You should see 3 NEW instances appearing:
    State: Pending â†’ Running
    
    (New instance IDs will be different from the old ones!)

â˜ 4.4 Wait until all 3 show:
    â”œâ”€ State: "running" (green)
    â”œâ”€ Status checks: "Initializing..." â†’ "2/2 checks passed"
    â””â”€ All 3 instances visible

âœ“ STEP 4 COMPLETE - New instances running!

================================================================================
STEP 5: VERIFY SSM ROLE ATTACHED (1 minute)
================================================================================

â˜ 5.1 Go to EC2 â†’ Instances

â˜ 5.2 Click on one of the new instances

â˜ 5.3 Scroll down to "Details" tab

â˜ 5.4 Look for: "IAM role"

â˜ 5.5 Verify it shows: D7078E-EC2-SSM-Role âœ“

â˜ 5.6 Check the other 2 instances similarly
    â˜‘ Instance 2: IAM role = D7078E-EC2-SSM-Role
    â˜‘ Instance 3: IAM role = D7078E-EC2-SSM-Role

âœ“ STEP 5 COMPLETE - All 3 instances have SSM role!

================================================================================
STEP 6: VERIFY SSM CONNECTIVITY (2 minutes)
================================================================================

â˜ 6.1 Go to AWS Console â†’ Systems Manager â†’ Fleet Manager
    URL: https://eu-north-1.console.aws.amazon.com/systems-manager/

â˜ 6.2 You should see your 3 instances listed

â˜ 6.3 Check status of each:
    Instance 1: Status = "Online" (green) âœ“
    Instance 2: Status = "Online" (green) âœ“
    Instance 3: Status = "Online" (green) âœ“
    
    (If showing "Offline": wait 2-3 more minutes and refresh)

âœ“ STEP 6 COMPLETE - All instances managed by SSM!

================================================================================
STEP 7: TEST SSM CONNECTION (Optional - 1 minute)
================================================================================

â˜ 7.1 Still in Systems Manager, go to "Session Manager"

â˜ 7.2 Click "Start session"

â˜ 7.3 Select one of your instances

â˜ 7.4 Click "Start session"

â˜ 7.5 You should see a terminal prompt

â˜ 7.6 Type: uptime

â˜ 7.7 You should see system uptime output

â˜ 7.8 Type: exit (to close session)

âœ“ STEP 7 COMPLETE - SSM connection works!

================================================================================
STEP 8: RETRY FIS EXPERIMENT (5 minutes)
================================================================================

NOW YOUR INSTANCES ARE READY FOR FIS!

â˜ 8.1 Go to AWS Console â†’ Fault Injection Simulator
    URL: https://eu-north-1.console.aws.amazon.com/fis/

â˜ 8.2 Create new experiment

â˜ 8.3 Configure:
    Name: D7078E-Task5-CPU-Stress
    Service: EC2

â˜ 8.4 Actions section:
    Action type: Stress CPU
    Duration: 120 seconds
    CPU: 90%

â˜ 8.5 Targets section:
    Target type: EC2 Instances
    
    Method: Specify instances (or use tags if they match)
    
    Select your 3 instances:
    â˜‘ i-03b3951e1cff6aa9b (or the new instance ID)
    â˜‘ i-0a6b2c4bdce290dd0 (or the new instance ID)
    â˜‘ i-0d91bf046fcb0be90 (or the new instance ID)

â˜ 8.6 IAM role section:
    Create role if needed, or select existing FIS role

â˜ 8.7 Click "Create experiment"

â˜ 8.8 Review and click "Start experiment"

âœ“ EXPECTED: Experiment starts successfully! NO "InvalidTarget" error! âœ“

================================================================================
WHAT TO EXPECT DURING FIS EXPERIMENT (2-3 minutes)
================================================================================

Timeline:

Minute 0:
  â”œâ”€ Experiment starts
  â”œâ”€ FIS injects CPU stress on selected instance(s)
  â””â”€ Instance(s) CPU spikes to 90%

Minute 0-1:
  â”œâ”€ CloudWatch: CPU graph shows spike
  â”œâ”€ Health check may detect high CPU
  â”œâ”€ ALB may mark instance as unhealthy
  â””â”€ Request count may drop

Minute 1-2:
  â”œâ”€ ASG detects unhealthy instance
  â”œâ”€ ASG launches replacement instance
  â”œâ”€ Old instance terminates or recovers
  â””â”€ New instance boots

Minute 2:
  â”œâ”€ Stress command stops (120 seconds up)
  â”œâ”€ CPU drops back to normal
  â”œâ”€ Replacement instance becomes healthy
  â””â”€ HealthyHostCount back to 3

Minute 3+:
  â”œâ”€ System fully recovered
  â”œâ”€ All metrics normalized
  â””â”€ Experiment complete!

================================================================================
SCREENSHOTS TO COLLECT FOR TASK 5
================================================================================

During the FIS experiment, take screenshots of:

â˜ CloudWatch Dashboard (before failure):
  â””â”€ CPU normal, HealthyHostCount = 3

â˜ CloudWatch Dashboard (during stress):
  â””â”€ One instance CPU = 90%
  â””â”€ HealthyHostCount = 2 (dropping)

â˜ Target Group (during failure):
  â””â”€ One instance marked "Unhealthy"

â˜ ASG Activity (during replacement):
  â””â”€ "Launching 1 instance" message

â˜ CloudWatch Dashboard (during recovery):
  â””â”€ New instance becoming healthy
  â””â”€ HealthyHostCount = 3 again

â˜ CloudWatch Dashboard (after recovery):
  â””â”€ All metrics normalized

(These screenshots are deliverables for your lab report!)

================================================================================
TROUBLESHOOTING
================================================================================

âŒ Problem: Instances not showing in Fleet Manager (Step 6)
   Solution:
     1. Wait 5 more minutes (SSM agent takes time to register)
     2. Verify IAM role attached (EC2 â†’ Instances â†’ Details â†’ IAM role)
     3. Refresh Fleet Manager page (F5)
     4. If still offline: terminate instance, wait for ASG to relaunch

âŒ Problem: FIS still shows "InvalidTarget" error (Step 8)
   Solution:
     1. Verify all 3 instances show "Online" in Fleet Manager
     2. In FIS, use "Specify instances" (not tags)
     3. Manually select instances from dropdown
     4. Make sure instances are in "Running" state (not Pending)

âŒ Problem: ASG didn't launch new instances (Step 4)
   Solution:
     1. Check ASG desired capacity: should be 3
     2. Check ASG Activity tab for errors
     3. Wait 10 minutes (sometimes takes longer)
     4. If still nothing: manually set desired capacity to 3

================================================================================
SUMMARY
================================================================================

What you did:
  âœ“ Created IAM role: D7078E-EC2-SSM-Role
  âœ“ Updated Launch Template to use this role
  âœ“ Terminated old instances (without SSM role)
  âœ“ ASG launched 3 new instances (with SSM role)
  âœ“ Verified instances are managed by SSM
  âœ“ Retried FIS experiment (SUCCESS!)

Result:
  âœ“ FIS can now target your instances
  âœ“ No more "InvalidTarget" errors
  âœ“ Ready to complete Task 5 failure simulation
  âœ“ Instances properly configured for production

Time spent: ~10 minutes
Value gained: Full SSM/FIS capability for future cloud experiments!

================================================================================
NEXT: COMPLETE TASK 5
================================================================================

After verifying SSM works (Step 6), you're ready for Task 5:

1. âœ“ Three instances with SSM role: READY
2. âœ“ FIS can target them: READY
3. â†’ Run FIS experiment (Step 8)
4. â†’ Observe failure and recovery
5. â†’ Collect evidence (screenshots, logs, timeline)
6. â†’ Document findings for lab report

Task 5 is the main objective - show that:
  âœ“ Health checks detect failures
  âœ“ ALB removes failed instances
  âœ“ ASG replaces them automatically
  âœ“ System recovers without manual intervention
  âœ“ This is high availability in action!

Good luck! You're almost at the finish line! ğŸš€

================================================================================
