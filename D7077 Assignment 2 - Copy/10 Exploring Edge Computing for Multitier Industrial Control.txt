SECTION I.Introduction
Industrial automation is undergoing a significant transformation driven by the emergence of edge computing and wireless networking technologies. As shown in Fig. 1, the new generation of industrial automation systems features a two-tier computing architecture comprising local and edge computing platforms. Traditionally, industrial automation relies on local controllers running on microcontrollers or programmable logic controllers (PLCs) that are often embedded in control plants with wired connections to sensors and actuators. Edge computing platforms comprise edge servers located on industrial premises. To lower deployment and maintenance costs, edge servers may communicate with control systems through wireless technologies that are increasingly being adopted in industry [1], [2]. Despite their flexibility, wireless networks may suffer from data loss due to environmental factors, such as obstacles, noises, interferences, extreme weather, as well as cyberattacks. The reduced reliability of the wireless network results in degradation of the control performance. Therefore, compared with local controllers, edge servers provide the advantages of computation capacity at the cost of communication reliability and latency.

Fig. 1. - Multitier control system (local and edge tiers).

Fig. 1.
Multitier control system (local and edge tiers).

Show All

While edge computing has received significant attention in the industry, research on exploiting edge computing for industrial control has remained limited. In this article, we propose switching multitier control (SMC), a novel approach to optimize control performance at runtime on a two-tier computing platform. SMC dynamically switches control between local and edge platforms in response to changing network reliability. SMC has two salient features. First, in order to overcome theoretical challenges of analyzing control performance of complex systems under network dynamics [3]–​[5], it employs data-driven approaches to derive control switching policies. A key contribution of this approach is to formulate the platform selection problem as a data-driven classification problem, optimal platform classifier (OPC), which can be solved using models extracted from simulations. Second, it extends the Simplex framework [6]–​[10] to the distributed two-tier architecture comprising local and edge controllers. The Simplex approach enables SMC to dynamically optimize control performance without sacrificing stability. Furthermore, as a tool to study edge computing for industrial control, it presents wireless cyber–physical simulator-edge computing (WCPS-EC), a real-time hybrid simulator that integrates: 1) real computing platforms; 2) real or simulated wireless networks; and 3) simulated physical plants. The contributions of this article are fivefold.

An SMC architecture that dynamically switches control between local and edge controllers in response to changes in network reliability.

Data-driven approaches to derive switching policies for multitier control based on the classification models learned from simulations.

A controller-switching design that guarantees system stability by extending the Simplex approach to a multitier architecture.

A real-time hybrid simulator (WCPS-EC) for studying and evaluating control systems based on edge computing.

A case study on industrial robotic control demonstrating the advantage of SMC to optimize control performance while maintaining system stability.

The remainder of this article is organized as follows. Section II proposes the SMC architecture and design. Section III introduces a control-theoretic framework for enabling a systematic design of both a safety controller and a stability-ensuring switching policy. Section IV presents the data-driven approaches to optimize control performance based on physical states and network reliability. Sections V and VI describe the case study and performance evaluation of SMC for industrial robotic control. Section VII reviews related works and Section VIII concludes this article.

SECTION II.SMC Architecture
In industrial control, the states of physical plants (e.g., the joint position of a robotic arm) are monitored and controlled by either a local controller or an edge controller. The edge controllers communicate with the sensors and actuators of the physical plants through communication networks. However, to date wireless networks and edge computing face open challenges for industrial control with stringent requirements: 1) control performance, which is related to factory revenue and 2) system stability, which is related to the safety of factory operation. The system may face data loss over wireless networks. For example, if a control command is lost, the actuator may not react to changes in the physical states in time. Therefore, our goal is to improve control performance and guarantee stability in the presence of data loss over the wireless network.

This section presents an overview of SMC architecture. The objective of SMC is to: 1) dynamically optimize control performance and 2) guarantee system stability when the reliability of the wireless network changes dynamically. SMC exploits the two-tier platform by switching between the local controller and the edge controller in response to changing network reliability.

A wireless network incurs both communication latency and data loss. For digital control systems with periodic sampling, communication latency is acceptable as long as the packet meets its deadline (associated with the sampling period). When a packet misses its deadline, it is treated as a loss [11], [12]. In addition, industrial wireless network standards, such as ISA100 [13] and WirelessHART [14], employ TDMA protocols with predictable latency. In such systems, the impact of wireless networks on control is often manifested through packet losses. Therefore, we focus on addressing data loss in this article. Latency will be addressed in future work.

In this section, we introduce the SMC architecture and provide an overview of its switching logic and mechanisms. The design to guarantee system stability and optimize performance will be detailed in Sections III and IV, respectively.

A. System Model
SMC employs a pair of local/edge controllers for each feedback control loop. Compared to the local controller, the edge controller may run a more sophisticated control algorithm given the larger computational capacity of the edge server. The local controller is connected to sensors and actuators through a wired network with no data loss. The local controller and the edge controller communicate over wireless networks with varying data loss. An example of two-tier robotic control is shown in Fig. 2. At any time, only one controller is active and controls the physical plant at a sampling period Ts . Furthermore, a switching agent is co-located with each controller. The switching agent co-located with the active controller checks the trigger of stability status to determine whether to switch to the safety controller and checks the trigger for performance optimization every coordination period Tc to determine whether to switch to the controller with the optimal performance. If a switch is triggered, the control is transferred to the other controller along with the necessary state information using a switching protocol.

Fig. 2. - Two-tier control system of robotic arms.

Fig. 2.
Two-tier control system of robotic arms.

Show All

We now introduce the variables representing the physical and network states. x(k) denotes the state vector of the controlled system in the k th sampling period; and xe(k) denotes the state error vector defined as the difference between x(k) and its reference value. In our case study, we use the mean absolute error MAE:=(1/n+1)∑nk=0|xe(k)| , where n denotes the number of samples in the coordination period, as a suitable metric for control performance of a robotic system tracking a reference trajectory.

The control performance of the edge controller depends on the data loss over the wireless network. We explore two models to describe the data loss process: 1) independent and identically distributed (i.i.d) Bernoulli random distribution with packet loss ratio ρ and maximum loss bound η defined as the maximum number of consecutive packet loss and 2) two-state Markov chain with the probabilities of transiting from/to the packet loss state to/from the packet reception state as α and β , respectively. While these models are relatively simple, we show in our evaluation that they are effective in selecting the controller when used with data-driven approaches.

B. Switching Logic
The switching logic of SMC integrates two switching rules: 1) the Stability Switch for guaranteeing stability and 2) the OPC for selecting the optimal control platform.

The Simplex framework [6] supports high-performance and dependable control systems through the integration of an unverifiable complex controller, a verified safety controller, and a switching logic. When the system is in danger of entering an unrecoverable state, the switching logic makes the system switch to the safety controller. In this way, a control system can employ the complex controller while maintaining the guarantees of the safety controller. In the Simplex framework, the physical states satisfying all operational constraints, such as physical state restrictions and limits of actuation, are defined as admissible states. The set of recoverable states is a subset of the admissible states. If the given safety controller is used from these states, all future states will remain admissible. The Stability Switch in SMC extends the Simplex framework to our two-tier architecture to guarantee stability.

SMC extends the Simplex framework [6]–​[10] in three novel ways: 1) while earlier research on Simplex usually assumed that the safety controller and the performance controller are co-located on a same computational platform, SMC extends the approach to the distributed two-tier architecture comprising local and edge controllers; 2) we introduce OPC, a new data-driven classifier to select the optimal controller at run time; and 3) we integrate the Stability Switch and OPC in a coordinated switching logic that optimizes control performance without sacrificing stability.

Stability Switch: In SMC, the local controller serves as the safety controller as it usually employs a simple control law and has a reliable connection to sensors and actuators without data loss. The edge controller serves as the performance controller that can afford a sophisticated control law and suffers time-varying data loss over the wireless network. As illustrated in the left figure in Fig. 3, the physical system may operate in the recovery region (RR) or the performance region (PR) in terms of its physical states. RR is the region of recoverable states that can be stabilized by the local controller. PR is the subset of the RR, where either the local or the edge controller may be active as selected by the OPC at runtime. The derivation of PR is presented in Section III.

Fig. 3. - Regions and boundaries of SMC.

Fig. 3.
Regions and boundaries of SMC.

Show All

OPC: When the system operates in PR, the OPC is responsible for selecting between the local and edge controllers based on the network conditions and physical states. The control performance of the local and edge controllers depends on both the current network conditions and the physical states of the system. To overcome the theoretical challenges of analyzing control performance of complex systems under network dynamics [3]–​[5], OPC employs data-driven approaches to select controllers. The data-driven approach allows SMC to be adopted in a wide range of practical systems and networks. The inputs to the OPC include the physical states (e.g., xe ) and network conditions. The network conditions include the distribution and burstiness of data loss. e.g., ρ and η in the i.i.d. model, or α and β in the Markov chain model. The OPC may be trained based on simulation or experimental results. The design of OPC is detailed in Section IV.

Integration of Stability Switch and OPC: As illustrated in Fig. 3, when x∈PR , the OPC selects the controller that optimizes control performance based on network conditions and physical states. When x∉PR , control is switched to the local controller to guarantee stability. By designing the local controller and PR with theoretical guarantees and by setting the stability switch with higher priority, SMC can dynamically optimize control performance without sacrificing stability.

C. Switching Protocol
We now present the switching protocol used by SMC to execute the switching between local and edge controllers across the two-tier platform.

In the two-tier architecture, each controller is co-located with a switching agent. Each switching agent integrates the Stability Switch and the OPC. The OPC monitors network and physical conditions every Tc to achieve the platform that optimizes predicted control performance over the next Tc . The monitored network conditions depend on which loss model the OPC is trained on. If the OPC is trained on an i.i.d loss model, it measures the packet loss rate (ρ ) and the maximum number of consecutive packet loss (η ) over the last time window of Tc . If the OPC is trained on the Markov chain model, it measures the probabilities of transiting from/to the bad state (packet drop) to/from the good state (packet reception), α and β , respectively, over the last time window of Tc .

At any time, only one controller is active along with its switching agent. The active controller operates its control policy in each sampling period Ts to generate the actuation commands. When multiple tasks share the local or edge platform, schedulability analysis can be performed for each platform to guarantee that all the tasks remain schedulable when controllers are activated. As shown in the finite state machine (Fig. 4), the switching protocol works as follows.

When the local controller is active, the switching agent is invoked every Tc , the prediction horizon of OPC. If a) x∈PR and b) the OPC selects the edge controller as the optimal platform over the next prediction horizon Tc , the control switches to the edge controller. The switching agent on the local platform sends a switching command to the switching agent on the edge platform along with any state data, dl , needed by the edge controller. e.g., depending on control design, dl may include previous x .

When the edge controller is active, the switching agent checks if x∈PR every Ts and switches to a local controller immediately when x∉PR . The switching agent also invokes OPC every Tc . If the OPC selects the local controller as the optimal platform over the next Tc , the control switches to the local controller. The switching agent on the edge platform sends a switching command to the switching agent on the local platform along with any state data, de , needed by the local controller.

Fig. 4. - Finite state machine for SMC. The arrows represent platform switches, and the switching conditions are above the arrows. The main actions taken to switch the computation platform are below the horizontal arrows.

Fig. 4.
Finite state machine for SMC. The arrows represent platform switches, and the switching conditions are above the arrows. The main actions taken to switch the computation platform are below the horizontal arrows.

Show All

Given the criticality of the switching command, the switching agents rely on retransmissions and acknowledgments to ensure reliable communication. Furthermore, to ensure a higher level of assurance, the local controller may remain active to monitor the physical states and take over control when x∉PR . The local controller may also monitor the network condition using the control commands from the edge controller as heartbeat messages. When it has not received an actuation command from the edge controller within a timeout threshold, the local controller can take over the control. This approach enhances the dependability of SMC as it can switch to the local controller without the switching commands from the edge switching agent, e.g., when the network between the edge and local is completely jammed. The actuators can be designed to allow override by the local controller if it receives control commands from both controllers.

SECTION III.Local Controller and Performance Region
The key problem of a Stability Switch boils down to developing the local controller and the PR. We consider the system dynamics approximated by a linear time-invariant (LTI) model with linear constraints since a wide variety of systems can be represented with satisfactory accuracy by such LTI model
x˙=aTix≤bTju≤Ax+Bu1, i=1,2,…,q1, j=1,2,…,r(1a)(1b)(1c)
View SourceRight-click on figure for MathML and additional features.where (1b) are physical restrictions and (1c) are limits of actuators. The local controller is a state feedback controller, u=Kx . We next formulate a convex optimization problem to establish both the safety feedback gain, K , and RR
S={x|xTPx≤1}(2)
View SourceRight-click on figure for MathML and additional features.by applying the Lyapunov stability theory and linear matrix inequality (LMI) methodologies [7]–​[10], where P is a positive-definite matrix. P defines a Lyapunov function, xTPx , which is positive definite with a negative-definite derivative, thus guaranteeing the stability of the linear system.

We establish the local controller (K ) and S (Q=P−1 ) jointly by applying the method presented in [10]. We solve an optimization problem over feasible K and Q , subject to LMI constraints, such that the resulting closed-loop system is asymptotically stable and RR is maximized. Since the volume of RR given by (2) is proportional to det(Q−1)−−−−−−−√ , maximizing RR is equivalent to minimizing the determinant det(Q−1) . The LMI problem can be formulated as
minimizeQ,Zsubject tolog det(Q−1)Q>0QAT+AQ+ZTBT+BZ<0aTiQai≤1,i=1,2,…,q[1ZTbjbTjZQ]≥0,j=1,2,…,r.(3a)(3b)(3c)(3d)(3e)
View SourceRight-click on figure for MathML and additional features.Applying the change of variable, we obtain K=ZQ−1 and P=Q−1 . Constraints (3b) and (3c) are the stability (Lyapunov equation) constraints, and (3e) is an LMI constraint converted from (1c). Since multitier control systems are implemented on digital platforms, we discretize (1a) with sampling period Ts . We consider the worst case latency of Ts , since in our case (Table II, joint position control) the worst case end-to-end (E2E) latency of local safety controller is 6.19 ms which is shorter than Ts=50 ms, which results in the consideration of
x(k+1)=Adx(k)+Bdu(k−1).(4)
View SourceRight-click on figure for MathML and additional features.Considering the state feedback control u(k)=Kx(k) and defining a new state vector z(k)=[xT(k)xT(k−1)]T , the closed-loop form of the augmented system of z(k) is
z(k+1)=A¯dz(k)(5)
View SourceRight-click on figure for MathML and additional features.where
A¯d=[AdIN×NBdK0N×N].(6)
View SourceRight-click on figure for MathML and additional features.

TABLE I System Settings of the Case Studies
Table I- 
System Settings of the Case Studies

TABLE II Latency Measurements of Each Tier (in the Format of Median and Worst Case Latency Pair)
Table II- 
Latency Measurements of Each Tier (in the Format of Median and Worst Case Latency Pair)

We solve Q¯=P¯−1 by [7] as
maximizeQ¯subject tolog det(Q¯)Q¯>0Q¯A¯Td−A¯−1dQ¯<0α¯TmQ¯α¯m≤1,m=1,2,…,g(7a)(7b)(7c)(7d)
View SourceRight-click on figure for MathML and additional features.where α¯m=[αTm,01×N]T and α¯m=[01×N,αTm]T are the constraints corresponding to x(k) and x(k−1) , respectively. αTm=aTm , for m=1,…,q ; αTm=bTjK , for m=q+1,…,g , j=1,…,r , and g=q+r . The corresponding RR is
S={z(k)|z(k)TP¯z(k)<1}.(8)
View SourceRight-click on figure for MathML and additional features.

Remark 1:The stability condition of the two-tier control system is that x should stay in RR. Thus, control should be switched to the local controller before x leaves RR. SMC is designed to switch among two platforms in a distributed way. Hence, the switching latency is unavoidable. It may result in x out of RR. In order to guarantee stability, a smaller region of PR should be calculated. A practical solution would be to choose a smaller ellipsoid, e.g., an ellipsoid defined by xTPx=0.7 [6]. The distance d in Fig. 3 can be derived theoretically through the searching of control policies that drive x within RR to the boundary of RR in the shortest time, which can be formulated as a minimum-time optimal control problem and solved by the bang-bang control. If the resulting shortest time is shorter than the sum of Ts and switching latency, x belongs to PR.
Remark 2:When switching occurs, the actuation commands may change in a nonsmooth (discrete) fashion. The discrete changes in the actuation commands will not affect stability since the stability switch is rigorously derived for the system (4), and switches do not happen frequently (multiples of Tc ). In addition, there exist switching system designs that deal with discontinuous design space [15], which are not the focus of this article.
SECTION IV.Optimal Platform Classifier
OPC employs data-driven approaches to select controllers trained by simulations. Invoked every Tc , OPC measures the network conditions and physical states and selects the controller that is predicted to optimize control performance over the prediction horizon Tc . Our data-driven approach is inspired by simulation-guided certificate construction [16], [17], but we apply the data-driven approaches for different purposes and scenarios. Unlike certificate construction, the false positive of which is extremely dangerous to a control system, the OPC is designed to improve the control performance within the stabilizable PR, the misclassification of which does not affect system stability in SMC.

A. Cyber–Physical Inputs
There exist different approaches to model data loss in the context of networked control systems (NCSs): 1) modeling loss as stochastic processes [18], e.g., i.i.d Bernoulli random distribution [19], [20] and two-state Markov chain [21]; 2) modeling loss as weakly hard real-time constraints [22], e.g., (m , k ) model [11], [23]; and 3) modeling loss with consecutive loss bound [24], [25]. The (m , k ) model is commonly used in real-time scheduling for computing tasks and is not suitable for the probabilistic nature of wireless communication. Hence, we explore two stochastic models for data loss, including i.i.d process with consecutive loss bounds and two-state Markov chain. The i.i.d loss model is characterized by: 1) the loss ratio ρ and 2) the maximum number of consecutive packet loss count η . The two-state Markov chain loss (Gilbert-Elliott) model is characterized by: 1) the probability of transiting from the packet loss state to the reception state α and 2) the probability of transiting from the reception state to the loss state β . Our experiments show that the OPC trained by either model works for realistic wireless traces. In addition to the network conditions, OPC also takes the physical state errors, xe , as inputs. OPC, therefore, selects controllers based on both cyber (network) and physical states.

B. Data Collection
To train and test OPC, we conduct simulations of local and edge control by sampling the input values over their feasible ranges. Since that OPC is invoked every Tc at runtime, the simulation time for data collection is Tc such that SMC can optimize the control performance over the prediction horizon of Tc . We will study and discuss the choice of Tc in Section VI. Our simulations are performed for a robotic case study in WCPS-EC, a real-time hybrid simulator (see Sections V-C and VI for details).

We run simulations to collect data for i.i.d loss model and two-state Markov chain loss model, respectively. The simulations incorporate communication latency corresponding to the maximum latency of the local and edge platforms measured experimentally (see Section VI-A). Fig. 5(a) shows data collection and processing examples for cases of two-state Markov chain loss model when Tc=15 s (other experimental settings of this group of experiments are the same as in Section VI-A2). The three axes are OPC inputs, i.e., α , β , and initial xe . Each data point indicates one round of simulation for 15 s. The color bar indicates the log-scale MAE. We can see that when xe and β are low, and α is high, the edge control has smaller MAE. By comparing MAEs of edge control and local control, we label each data point with the optimal platform that achieves smaller MAE, as shown in Fig. 5(b).

Fig. 5. - Data collection, labeling, and classifying (Markov loss when 
$T_{c}=15$
 s, the color bar of (a) indicates log-scale MAE), (a) data collected for edge control, (b) optimal platform labeling.

Fig. 5.
Data collection, labeling, and classifying (Markov loss when Tc=15 s, the color bar of (a) indicates log-scale MAE), (a) data collected for edge control, (b) optimal platform labeling.

Show All

C. Classifier: Training and Testing
We then train classifiers to select the local or edge platform (as shown in Fig. 6). We explore two classification models, threshold-based classification and support vector machines (SVMs). The goal of a classifier is to identify the optimal platform boundary (OPB), i.e., the boundary that separates the regions in which the local and edge platforms achieve better control performance, respectively. While simple to train and efficient at runtime, a threshold-based classifier may not be able to achieve a close approximation of the OPB that is often nonlinear in practical systems. In comparison, SVM is a well established and powerful method to efficiently establish the separation boundary of arbitrary data sets, even when the training data are not linearly separable [26]. We train and compare both classifiers in this article.

Fig. 6. - OPC (with Markov data loss).

Fig. 6.
OPC (with Markov data loss).

Show All

For the threshold-based classifier, we use grid search to find the set of thresholds that minimize the classification error on the training datasets. For example, for the two-state Markov chain loss model, we exhaustively sweep all feasible values of α , β , and xe at certain step sizes to find the set of parameters that leads to the minimum classification error. We tuned the step sizes to balance the search time and classification error. The step sizes used to generate the thresholds are 0.067 for α and β , and 0.53 for xe . For SVM, we use the radial basis kernel function, proper box constraint, and kernel scale to minimize the tenfold cross-validation loss on the training datasets.

We trained and tested the classifiers on our training and testing datasets, respectively. The OPBs established by the threshold-based (Grid) classifier and SVM are shown as the two shaded surfaces in Fig. 7, respectively. The regions to the left and right of the boundaries are classified as edge and local control, respectively. As expected, when xe and β are low, and α is high, OPC will choose edge control, and local control otherwise. Notably, SVM establishes a nonlinear boundary separating edge control and local control while the threshold-based classifier identifies a cube-shaped boundary.

Fig. 7. - OPBs derived by threshold-based classifier and SVM, and testing results (Markov loss, 
$T_{c}=15$
 s), (a) threshold-based (Grid) classifier, (b) SVM.

Fig. 7.
OPBs derived by threshold-based classifier and SVM, and testing results (Markov loss, Tc=15 s), (a) threshold-based (Grid) classifier, (b) SVM.

Show All

The testing results of SVM are shown in Fig. 7 (misclassified points are circled in red). We observe that the miss classifications happen near OPB, where local and edge controllers have similar control performance. Fig. 8 shows the empirical cumulative distributions of MAE difference of local and edge control in their correct classification sets and in their miss classification sets, respectively. The results confirm that misclassifications have moderate impacts on control performance for both classifiers. The SVM outperforms threshold-based (Grid) classification in the miss classification set since SVM establishes a more accurate boundary. We train two sets of OPCs based on the i.i.d loss model and two-state Markov chain loss model to show the generality of the data-driven approach. Both OPCs work for realistic wireless traces, which will be discussed in Section VI-B2.

Fig. 8. - CDF of MAE difference for local and edge control in the correct classification sets and miss classification sets, respectively.

Fig. 8.
CDF of MAE difference for local and edge control in the correct classification sets and miss classification sets, respectively.

Show All

Remark 3:Due to the generality of the data-driven approach, the OPC can be trained for other metrics of control performance. For example, to optimize the settling time of a control system, the OPC can be trained to select the optimal control platform with the shortest settling time. Furthermore, to minimize settling time, the local and edge controllers can be designed to maximize the convergence speed with proper closed-loop eigenvalues [27] or learning-based approaches [28]. For our robotic case study, as we consider a linear state-space model for the plant, we can design the stabilizing controller to result in a certain convergence rate of the closed-loop system, which is readily given in terms of the eigenvalues of the closed-loop system matrix.
SECTION V.Case Study Design for Multitier Control
Fig. 2 shows a case for multitier control, where single or multiple robotic arms are in a workshop of a factory. We will utilize this case study to explore the multitier control system in the rest of this article. The objectives are to control the velocity and position of the independent joints.

In order to evaluate multitier control and SMC, we built WCPS-EC, a real-time hybrid simulator that integrates real multitier computation platforms, real or simulated wire/wireless networks, and physical plants simulated in Simulink.

A. Physical Plants
A robotic arm comprises a chain of joints and rigid links. The motion of the end effector is the composition of the motion of each link, and the links are ultimately moved by forces and torques exerted on the joints.

The most common structure for joint control is the nested control loop. The outer loop is responsible for maintaining position and determines the velocity of the joint that will minimize position error. The inner loop is responsible for maintaining the velocity of the joint as demanded by the outer loop. The motor drive assembly comprises a motor to generate torque, a gearbox to amplify the torque and reduce the effects of the load, and an encoder to provide feedback about position and velocity. We can write the torque balance on the motor shaft as
KmKau−B′ω−τ′C(ω)−τd(q)G=J′ω˙(9)
View SourceRight-click on figure for MathML and additional features.where Km is the motor torque constant, Ka is the transconductance of the amplifier, q is the joint coordinates, w is the joint velocity, and u is the control voltage. B′ , τ′C , and J′ are, respectively, the effective total viscous friction, Coulomb friction, and inertia due to the motor, gearbox, bearings, and the load. τd(q) is the disturbance torque due to the link motion. In order to analyze the dynamics of (9), we linearize it by setting all additive constants to zero
J′ω˙+B′ω=KmKau(10)
View SourceRight-click on figure for MathML and additional features.which admits the transfer function description
Ω(s)U(s)=KmKaJ′s+B′.(11)
View SourceRight-click on figure for MathML and additional features.The outer position loop provides the velocity demand for the inner velocity loop.

We modify the open-source Robotics ToolBox [29] to simulate a PUMA560 robotic arm in a multirate and real-time fashion. We refer readers to [29] for the underlying kinematics and dynamics of the robotic arm and the guide for the toolbox, and to [30] and [31] for the parameters of PUMA560.

B. System Settings of Local and Edge Platforms
The architecture of our case studies for exploring the multitier control system was shown in Fig. 2. The settings of the computation platforms and communication approaches that we use are described in Table I.

C. Wireless Cyber–Physical Simulator-Edge Computing
It is challenging to conduct experiments on industrial control systems in the field, especially under cyber and physical disturbances. We built a real-time hybrid simulator, WCPS-EC, which integrates: 1) real controllers running on various computation platforms; 2) real Wi-Fi network and Ethernet, or simulated network using TOSSIM; and 3) simulink desktop real time (SLDRT), which simulates the robotic arm in real time.

The architecture of WCPS-EC is shown in Fig. 9. Compared with RT-WCPS [32], WCPS-EC includes immigrated controllers running on various computation platforms instead of controllers running in MATLAB/Simulink. In addition, WCPS-EC can reflect the impacts of real communication network and computation platform during runtime.

Fig. 9. - Architecture of WCPS-EC.

Fig. 9.
Architecture of WCPS-EC.

Show All

We implement the control policies in Python and C [33] so that the policies can run on any platforms that support Python or C. Based on our measurements, while the controller written in C has a slightly shorter execution time than the Python implementation, the difference is not significant as the computation time is dominated by solving the same quadratic programming problem. In RT-WCPS, the worst case E2E latency is below Ts . Hence, the actuation commands are set to have fixed latency of Ts . However, in multitier control systems, the E2E latency can be longer than Ts . In addition, we consider a more realistic control system setup [4], [8], [34] with: 1) clock-driven sensors that sample the plant outputs periodically every Ts ; 2) an event-driven controller which calculates the actuation commands as soon as the sensor data arrives; and 3) event-driven actuators, which means actuators can respond to updated actuation commands immediately.

As shown in Fig. 9, Sensors sample periodically (e.g., 20 Hz), and write the new measurements to a Sensor Data File. The Sensor Client, located on the host of SLDRT, discovers the sensing update immediately and sends it to the Sensor Server via a wired or wireless networks. The event-driven Controller starts operation once Sensor Server receives the sensing measurements, and sends the control commands to Control Server, which writes the control commands to the Commands File. The actuator in SLDRT checks the Commands File with high frequency (e.g., 500 Hz) and updates the actuation once it discovers an update of control commands. The intermediate File Interface is introduced between Simulink and the computation platform. In this way, Simulink and the computation platform are asynchronous, which is essential for the sequential execution of the Simulink loop.

SECTION VI.Case Study Evaluation
We evaluate the multitier control and SMC in the case study introduced in Section V. We explore control systems with static local and edge controllers. Two cases, i.e., multitier control of joint velocity and of joint position, are evaluated from the aspect of control performance. Next, we evaluate the SMC that optimizes performance and guarantees system stability.

A. Evaluation of Static Cases
When the network is in normal condition, Table II summarizes the latencies of different tiers of control with the system settings described in Table I. We choose proportional-integral-derivative (PID) and model predictive control (MPC) as alternative control policies for independent joint velocity and position control. As shown in Table II, since PID is more computationally lightweight than MPC, the computational latency of PID is shorter than that of MPC over both local and edge platforms. Since the edge platform is equipped with more computation capacity than the local platform, it finishes PID and MPC within 0.05 and 4.5 ms, respectively, while the local platform requires 2.8 and 61.7 ms, respectively. On the other hand, communication latency between the local platform and the plant is around 5 ms, which is much shorter than ~30 ms of the edge platform. In summary, edge can run MPC much faster than local due to higher computation capacity at the cost of longer communication latency.

1) Case 1—Joint Velocity Control of PUMA560:
The physical plants described by (10) are discretized and simulated at 1000 Hz to mimic a continuous system. The sampling rate of the sensors is 200 Hz, a reasonable rate for the system time constant of joint velocity control. The settings for communication between sensors/actuators and the computation platform are shown in Table I. The communication latency of the case studies is shown in Table II.

The response curves of the joint velocity control are shown in Fig. 10. The reference value of the physical state w is w∗ . For joint velocity control that has a short time constant (high sensitivity to latency), the local controller, which has the shortest latency, performs the best. We ran experiments for 30 times. The statistical results for MAE are shown in Fig. 12(a). PID over local has the best control performance, which is consistent with the observation in Fig. 10.

Fig. 10. - Response curves of the joint velocity control. (a) PID over local. (b) MPC over edge.

Fig. 10.
Response curves of the joint velocity control. (a) PID over local. (b) MPC over edge.

Show All

Fig. 11. - Response curves of the joint position control. (a) PID over local. (b) MPC over edge.

Fig. 11.
Response curves of the joint position control. (a) PID over local. (b) MPC over edge.

Show All

Fig. 12. - Performance of the joint velocity and position control. (a) Joint velocity control. (b) Joint position control.

Fig. 12.
Performance of the joint velocity and position control. (a) Joint velocity control. (b) Joint position control.

Show All

2) Case 2—Joint Position Control of PUMA560:
The settings for the joint position control are mostly the same as for the joint velocity control described in Section VI-A1, except that the sampling rate is 20 Hz since the time constant is much longer than that of velocity control. We control the joint position (θ ) to track a sinewave signal (θ∗ ), which is common in position control of robots [35]. The response curves and the statistical results of the joint position control are shown in Figs. 11 and 12(b), respectively. The edge controller performs the best since the gain of MPC on edge overcomes the effects of extra communication latency.

In summary, for joint velocity control, PID over local has the best performance, since it is sensitive to latency. For joint position control, MPC over the edge has the best performance since MPC performs better than PID, which overcomes the effects of longer communication latency. The control performances of control tiers are determined by the properties of control policies, networks, and physical plants. The advantage of the two-tier computing architecture is enabled by the flexibility in controller placements and the choice of corresponding control policies tailored for physical plants.

Note that the MPC controller over local is infeasible due to the computational resource shortage on edge: the computation latency is longer than the sampling period. For instance, in Table II, the maximum computational latency of MPC over local is 61.7 ms, which makes it infeasible for a sampling period of 50 ms. In this section, the network conditions are normal. The performance of the closed-loop control system may deteriorate due to the unreliable wireless network connection between the edge controller and the plant [4]. In the next section, we will focus on evaluating SMC facing changing data loss.

B. Evaluation of SMC
1) OPC Training and Testing:
We run 26 000 simulations to collect around 40-GB data for i.i.d loss model and Markov chain loss model, respectively. We set the worst case end-to-end latency of local control and edge control to 7 and 40 ms, respectively, based on the measurements in Table. II. For each data loss model (i.i.d or Markov), we randomly choose 6500 simulations as the training set, and the other 6500 as a testing set. The accuracies of training and testing are summarized in Table III. SVM consistently achieved higher accuracies than the threshold-based (Grid) classification. The average time taken by one SVM classification is 0.67 and 10.27 ms on the edge and local platforms (over 20 000 testing cases), respectively, which suggests that online classification is practical even on a local platform. The average time it takes to train the SVM classifier is 26.62 s on the edge server (over 100 training runs). It is a reasonable amount of time since training is done offline.

TABLE III Accuracy of Threshold-Based (Grid) and SVM Classifiers. (The Training Accuracies of Grid and SVM are From the Grid Search and Tenfold Cross-Validation, Respectively, on the Training Datasets. The Testing Accuracies are Measured on the Testing Datasets)
Table III- 
Accuracy of Threshold-Based (Grid) and SVM Classifiers. (The Training Accuracies of Grid and SVM are From the Grid Search and Tenfold Cross-Validation, Respectively, on the Training Datasets. The Testing Accuracies are Measured on the Testing Datasets)

2) Performance Optimization:
In order to evaluate SMC, we consider joint position control with the same settings as described in Section VI-A2, except that we simulate data loss based on traces generated by TOSSIM [36], [37], which is a high-fidelity wireless simulator. Received signal strength indicator (RSSI) data have been collected over real wireless testbed. In addition, we use controlled background noise strength to simulate various network conditions between edge and local as shown in Fig. 13(a). Both the RSSI and controlled noise strength are fed into TOSSIM to derive realistic packet loss traces. The OPC (SVM trained for i.i.d loss model and Tc=10 s) monitors ρ and η during a sliding window of the past Tc (10 s), as shown in Fig. 13(b) and (c). The runtime position error inputs of OPC are shown in Fig. 13(d). The optimal platform derived by OPC is shown in Fig. 13(e). We can see that edge control is the best choice when the noise level is low, and the control should be switched to local when the noise level is high since the gain of the edge control is offset by the effects of data loss.

Fig. 13. - System dynamics under SMC. (
$T_{c}=10$
 s, i.i.d data loss).

Fig. 13.
System dynamics under SMC. (Tc=10 s, i.i.d data loss).

Show All

With a coordination period Tc of 10 s, we observe a 10-s delay of OPC in reacting to the changes of the noise level. Fig. 14(a) compares the control performance of SMC with various Tc , fixed local control, and fixed edge control over 30 rounds of simulations. When Tc is properly chosen, i.e., 10–15 s, our SMC provides over 30% and 40% MAE reduction over fixed local control and edge control, respectively. While the OPC is trained based on the i.i.d loss model, it works for more realistic loss traces generated by TOSSIM as well.

Fig. 14. - Control performance under SMC, fixed local control, and fixed edge control. (a) Under changing noise as in Fig. 13(a). (b) Frequently changing noise. (c) Under frequently changing noise as in (b).

Fig. 14.
Control performance under SMC, fixed local control, and fixed edge control. (a) Under changing noise as in Fig. 13(a). (b) Frequently changing noise. (c) Under frequently changing noise as in (b).

Show All

To study the impact of Tc , we run experiments under more frequently changing noise [Fig. 14(b)]. As shown in Fig. 14(c), SMC achieves the best performance with Tc=10 s. When Tc is too short, the OPC is trained based on the data of transient physical states without taking steady states into consideration. On the other hand, when Tc is too long, the OPC cannot react to frequently changing network conditions in time. We will explore adaptive Tc to balance the above factors in the future.

In Fig. 15, we compare the performance of the OPC trained based on the i.i.d loss model and that based on the Markov chain loss model. The OPC performs similarly when trained with different data loss models, which suggests the generality and robustness of the data-driven approach for selecting optimal platforms.

Fig. 15. - Performance comparison of OPC based on the i.i.d loss model and the Markov loss model. (a) Changing noise as in Fig. 13(a). (b) Changing noise as in Fig. 14(b).

Fig. 15.
Performance comparison of OPC based on the i.i.d loss model and the Markov loss model. (a) Changing noise as in Fig. 13(a). (b) Changing noise as in Fig. 14(b).

Show All

In Fig. 16, we compare the control performance under learning-based (SVM) and threshold-based (Grid) OPC. Thanks to its higher classification accuracy, SVM generally outperforms Grid. Furthermore, SVM is a more general and precise approach that may lead to more significant improvement when the cost of misclassification is higher under other settings, which we will evaluate in future work.

Fig. 16. - Performance comparison of learning-based (SVM) and threshold-based (Grid) OPC [with Markov loss model, under noise as in Fig. 14(b)].

Fig. 16.
Performance comparison of learning-based (SVM) and threshold-based (Grid) OPC [with Markov loss model, under noise as in Fig. 14(b)].

Show All

3) Stability Analysis:
We model the joint position control by treating the inner velocity loop as constant since the response of the velocity loop is much faster than that of the position loop, as shown in Figs. 10 and 11
θ˙(t)=−KgKpθ(t).(12)
View SourceRight-click on figure for MathML and additional features.We define θ~(t)=θ(t)−θ∗(t) , and the proportional controller u(t)=−Kpθ~(t) . To achieve the equilibrium point at the origin, we transform the coordinates of (12)
θ~˙(t)=−KgKpθ~(t)=Kgu(t).
View SourceRight-click on figure for MathML and additional features.Solving (3), among multiple solutions, we choose Kp=800 .

Then, we model the discrete system with one sampling period latency (Ts ) using the Euler method

z(k+1)=[11−TsKgKp0]z(k) , where z(k)=[θ~(k)θ~(k−1)] .

We solve (7) by using YALMIP and the multiparametric toolbox (MPT) with semidefinite programming solver (SDPT3) solver in MATLAB
⇒Q¯=[2.8373.3823.3827.834]⇒P¯=[0.732−0.316−0.3160.264].
View SourceRight-click on figure for MathML and additional features.The corresponding RR is
S={z(k)|z(k)TP¯z(k)<1}.
View SourceRight-click on figure for MathML and additional features.We confirm that during the dynamic switch process, all physical states are within this RR. Therefore, stability is guaranteed, and no Stability Switch is needed.

SECTION VII.Related Work
The cloud computation platforms proposed and commercialized in last two decades for large-scale data centers are famous for their high computing ability, voluminous data storage, and low cost [38]–​[40]. The cloud-based IIOT provides a centralized solution for statistical data analysis of increased amounts of tasks and data. Many mainstream cloud computing vendors, such as Amazon, Google, and IBM, have offered services in various domains, such as data management and analysis, and intelligent transportation systems. However, for industrial control systems, a cloud-based computation platform suffers from long and fluctuating latency to end devices because it is up to hundreds of miles away from the end devices [41].

In the recent decade, the increase of IoT devices at the edge of the network and the evolution of hardware with increased computational capability have spawned the edge computation platform. Compared with the cloud-based platform, the edge platform benefits from the localization of computation resources [42]. The ability to provide local data aggregation and processing not only reduces the bandwidth demand on network links to the cloud [43] but also meets the latency requirements of applications [44]. Therefore, although only in its early stage, edge computing is already widely deployed among applications with low-latency requirements, such as vehicles [45], mobile gaming [46], and health monitoring [47]; applications dealing with large amounts of data, such as video [48] and large-scale sensor networks [49]; and applications with geographical distribution [50] and mobility [51], such as mining, smart grid, transportation, waste management, and agriculture [52]. However, few edge computing technologies have been applied to industrial control systems thus far.

In a conventional industrial control system, the control algorithm runs on a local controller, which is usually deployed physically near the sensors and actuators and implemented with an SCM or PLC [53] with a reliable wired connection but limited computational ability. In recent years, the physical plants tend to be controlled by a remote controller for the advantages of: 1) more conductive environments for hardware implementation of control algorithms and 2) centralized control and coordination of multiple plants. Due to the network connection between the remote controller and the physical plant, remote control systems are regarded as NCSs [1], [2].

We note that there are remote controller designs that guarantee stability in a mean square sense in the presence of data loss. The design is based on stochastic Lyapunov functions [54], [55], as well as certain assumptions about the communication network. However, the unpredictable wireless conditions mean that the assumptions may not be guaranteed, leading to unsafe physical plant operations with deteriorated performance.

Lin and Antsaklis [56] and Liberzon and Morse [57] summarized switching control approaches that maintain stability. Dai et al. [58] established an optimization framework for switching sampling periods that maximizes the control performance and CPU resource efficiency. However, those work do not consider control over wireless networks and multitier computing platforms. The Simplex framework ensures the safe use of an unverifiable complex controller by using a verified safety controller and a switching logic. In the conventional Simplex framework [6], the complex controller and safety controller operate in parallel. ORTEGA [7] enhances the efficiency and flexibility of Simplex by eliminating the redundant execution of controllers. NetSimplex [8] extends the Simplex from a single node control system to an NCS. Bak et al. [9] derived the switching logic by combining offline LMI results and online reachability computation, which significantly reduces conservatism. In all the above cases, both the complex controller and safety controller are running on the same computation platform. Whereas most previous works consider single machine cases, we extend the Simplex framework by considering: 1) distributed two-tier architecture comprising local and edge controllers; 2) new data-driven OPC for control performance optimization; and 3) a coordinated switching logic which integrates stability switch and OPC.

Ma et al. [5] designed the stability switch between local and edge controllers under data loss from another perspective, based on the co-design of edge and local controllers that are designed via a joint Lyapunov function. The co-design approach is nontrivial and specific to the control policy. In comparison, by extending the Simplex framework to the distributed two-tier architecture, our SMC approach can be applied to any control policies on edge without sacrificing stability.

Data-driven approaches have been applied to control design [59] and safety verification of control systems [17] to overcome the restrictions of analytical modeling. We develop our data-driven approach for a different purpose and system architecture. The data-driven OPC is designed to improve the control performance by selecting the optimal control platform in a distributed two-tier computing architecture.

Skarin et al. [60] presented a 5G-based edge cloud computing testbed for a multitier control system and evaluated the system while operating a mission-critical control application of an MPC controlled ball and beam process. However, systematic studies, such as how to co-design proper computation platforms and control policies, and how to adjust to uncertainties and maintain closed-loop stability, remain to be performed. Ma et al. [32], [61] proposed the concept of holistic control that co-joins network management and physical control at run time, where the focus is the remote control. In this article, we focus on a multitier industrial control system with a comprehensive view of the properties of the edge/cloud controller, network conditions, and physical plants. We also propose a controller dynamic switch among multitier computation platforms which not only optimizes the control performance at runtime but also guarantees system stability under various network conditions.

Simulation tools are of vital importance to study multitier control. NCS simulators [36], [62], [63] are MATLAB/Simulink-based tools, which enable simulations of CPU scheduling, communication, and control by integrating wireless simulators. Given simulators cannot always capture the real-world wireless network dynamics, network-in-the-loop simulations have recently been developed [32], [64]. Skarin et al. [60] presented a 5G-based edge cloud computing testbed for a multitier control system. However, the real physical plants used in its experiments are limited to lab settings. We build WCPS-EC, which integrates real multitier computation platforms and wireless networks and leverages simulation support for various physical plants.

SECTION VIII.Conclusion
With the emergence of edge computing and wireless network technologies, controllers located in various computational tiers have different computational capacities and communication reliability, which influence the performance and stability of industrial control systems. We presented an SMC architecture for industrial control systems. SMC dynamically switches between local and edge control based on plant states and network reliability. It employs a switching agent that integrates: 1) a data-driven optimal performance classifier for selecting the controller platform with optimal performance and 2) a Stability Switch for guaranteeing system stability. SMC effectively reaps the benefits of switching among different computation tiers. In hybrid simulations on WCPS-EC, SMC achieved over 30% and 40% reductions in mean absolute errors when compared with fixed local and edge control, respectively, while maintaining stability guarantees under changing network reliability.